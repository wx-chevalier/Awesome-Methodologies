[![è¿”å›ç›®å½•](https://parg.co/UCb)](https://github.com/wxyyxc1992/Awesome-CheatSheets)

> ğŸ“Œ ç›¸è¾ƒäºè¿™äº›å‚è€ƒèµ„æ–™æœ¬æ–‡å¸Œæœ›èƒ½å¤Ÿæ›´ä¸ºç”ŸåŠ¨è¯¦ç»†ï¼Œå¹¶ä¸”ä¸ä»…ä»…å±€é™äº Bash æœ¬èº«ï¼Œè€Œæ˜¯åŒ…å«å…·æœ‰ä¸€å®šä»·å€¼çš„å…¶ä»–æ‰©å±•å‘½ä»¤ï¼Œä»è€Œæ›´è´´è¿‘äºæ—¥å¸¸å·¥ä½œä¸­çš„éœ€è¦ã€‚

# Linux Commands CheatSheet | å¸¸ç”¨å‘½ä»¤ä¸æŠ€å·§æ¸…å•

Shell å³æ˜¯ç”¨æˆ·å’Œ Linux å†…æ ¸ä¹‹é—´çš„æ¥å£ç¨‹åºï¼Œå…¶å¯ä»¥è¢«çœ‹åšå‘½åè¯­è¨€è§£é‡Šå™¨ï¼ˆCommand-Language Interpreterï¼‰ã€‚Bash(Bourne Again Shell) åˆ™æ˜¯ Bourne Shell(Sh) çš„æ‰©å±•ï¼Œå…¶ä¼˜åŒ–äº†åŸæœ¬ç”¨æˆ·è¾“å…¥å¤„ç†çš„ä¸è¶³ï¼Œæä¾›äº†å¤šç§ä¾¿æ·ç”¨æˆ·è¾“å…¥çš„æ–¹å¼ã€‚

# å‘½ä»¤æ‰§è¡Œ

# æ–‡ä»¶ç³»ç»Ÿ

## æ–‡ä»¶æ£€ç´¢

ä½¿ç”¨ `ls -l` æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨:

```sh
# ç»Ÿè®¡ /home/han ç›®å½•ï¼ˆåŒ…å«å­ç›®å½•ï¼‰ä¸‹çš„æ‰€æœ‰ js æ–‡ä»¶
$ ls -lR /home/han | grep js | wc -l

$ ls -l "/home/han" | grep "js" |wc -l

$ ls -l --sort=size --block-size=M
```

è¿™ç±»ä¼¼äº SQL ä¸­çš„ % ç¬¦å·ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨ `WHERE first_name LIKE ã€John%` æœç´¢æ‰€æœ‰ä»¥ John èµ·å§‹çš„åå­—ã€‚åœ¨ Bash ä¸­ï¼Œç›¸åº”çš„å‘½ä»¤æ˜¯ `John*`ã€‚å¦‚æœæƒ³åˆ—å‡ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰ä»¥ `.json` ç»“å°¾çš„æ–‡ä»¶ï¼Œå¯ä»¥è¾“å…¥ `ls *.json`ã€‚

```sh
# æ ¹æ®æ–‡ä»¶ç±»å‹æœç´¢
$ find * -type f | fzf > selected

# æ ¹æ®æ–‡ä»¶ååŒ¹é…
$ find . -name '*.map' -exec rm {} \;

# æ‰¹é‡ä¿®æ”¹æ–‡ä»¶çš„æƒé™
$ find /opt/lampp/htdocs -type f -exec chmod 644 {} \;
```

å¯ä»¥ä½¿ç”¨ [fzf](https://github.com/junegunn/fzf) è¿›è¡Œäº¤äº’å¼æ£€ç´¢ï¼Œåœ¨[è¿™é‡Œ](https://github.com/junegunn/fzf-bin/releases)ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶

## æ–‡ä»¶æ“ä½œ

```shell
# åˆ›å»ºæ–‡ä»¶å¤¹
mkdir <name>

# é€’å½’åˆ›å»ºçˆ¶æ–‡ä»¶å¤¹
mkdir -p / --parents backup/old

# åˆ›å»ºæ–‡ä»¶å¤¹æ—¶åŒæ—¶æŒ‡å®šæƒé™
mkdir -m a=rwx backup

mkdir -p -m 777 backup/server/2011/11/30
```

```sh
# å°†æ–‡ä»¶è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶å
$ tar -xvzf fileName.tar.gz -C newFileName

# å°†æ–‡ä»¶å¤¹å‹ç¼©åˆ°æŒ‡å®šç›®å½•
$ tar -czf target.tar.fz file1 file2 file3

# æŒ‡å®šæ–‡ä»¶ååˆ›å»ºå‹ç¼©åŒ…
$ tar -cv -f archive.tar file1.txt file2.txt

# è¿‡æ»¤æŸä¸ªæ–‡ä»¶å¤¹ä¸‹é¢çš„æŸäº›å­æ–‡ä»¶å¤¹
$ tar cfvz --exclude='<dir1>' --exclude='<dir2>' target.tgz target_dir
$ tar cvf dir.tar.gz --exclude='/dir/subdir/subsubdir/*' dir

# å‘å‹ç¼©åŒ…ä¸­æ·»åŠ æ–‡ä»¶
$ tar -rf archive.tar file3.txt
```

æœ‰æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦å°†å¤§å‹æ–‡ä»¶è¿›è¡Œåˆ‡å‰²å¤„ç†ï¼š

```sh
$ split -b 10M home.tar.bz2 "home.tar.bz2.part"
$ ls -lh home.tar.bz2.parta*
# æ··åˆ tar å‘½ä»¤ä½¿ç”¨
$ tar -cvzf - wget/* | split -b 150M - "downloads-part"

# æ‹¼æ¥æ–‡ä»¶
$ cat home.tar.bz2.parta* >backup.tar.gz.joined
```

## åˆ†åŒºä¸æŒ‚è½½

fdisk å¸¸ç”¨äºè¿›è¡Œç£ç›˜åˆ†åŒºï¼Œä¸»åˆ†åŒºï¼ˆåŒ…å«æ‰©å±•åˆ†åŒºï¼‰ã€é€»è¾‘åˆ†åŒºï¼Œä¸»åˆ†åŒºæœ€å¤šæœ‰ 4 ä¸ªï¼ˆåŒ…å«æ‰©å±•åˆ†åŒºï¼‰ã€‚å› æ­¤æˆ‘ä»¬åœ¨å¯¹ç¡¬ç›˜åˆ†åŒºæ—¶æœ€å¥½åˆ’åˆ†ä¸»åˆ†åŒºè¿ç»­ï¼Œæ¯”å¦‚è¯´ï¼šä¸»åˆ†åŒºä¸€ã€ä¸»åˆ†åŒºäºŒã€æ‰©å±•åˆ†åŒºã€‚

```sh
# æŸ¥çœ‹ç³»ç»Ÿä¸Šçš„ç¡¬ç›˜
$ fdisk -l

# æ“ä½œæŒ‡å®šç£ç›˜
$ fdisk /dev/sda

# åˆ—å‡ºå½“å‰æ“ä½œç¡¬ç›˜çš„åˆ†åŒºæƒ…å†µ
$ p

# åˆ é™¤æŸä¸ªåˆ†åŒº
$ d

# å¢åŠ æŸä¸ªåˆ†åŒº
$ n
```

`mkfs.ext4` ç­‰å¸¸ç”¨äºå¯¹åˆ†åŒºè¿›è¡Œæ ¼å¼åŒ–ï¼Œmount åˆ™æ˜¯ç”¨äºæŒ‚è½½åˆ†åŒºï¼š

```sh
# æ ¼å¼åŒ–
$ mkfs.ext4 /dev/xvdb1

# æŒ‚è½½
$ mount /dev/xvdb1 /data2

# å¸è½½
$ umount /data2
```

## ç£ç›˜ IO

ä½¿ç”¨ du(disk usage)/df(disk free) æŸ¥çœ‹ç£ç›˜çŠ¶æ€ï¼Œdu æ˜¯é€šè¿‡æœç´¢æ–‡ä»¶æ¥è®¡ç®—æ¯ä¸ªæ–‡ä»¶çš„å¤§å°ç„¶åç´¯åŠ ï¼Œdu èƒ½çœ‹åˆ°çš„æ–‡ä»¶åªæ˜¯ä¸€äº›å½“å‰å­˜åœ¨çš„ï¼Œæ²¡æœ‰è¢«åˆ é™¤çš„ã€‚ä»–è®¡ç®—çš„å¤§å°å°±æ˜¯å½“å‰ä»–è®¤ä¸ºå­˜åœ¨çš„æ‰€æœ‰æ–‡ä»¶å¤§å°çš„ç´¯åŠ å’Œï¼›df è®°å½•çš„æ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿè·å–åˆ°çš„æ–‡ä»¶çš„å¤§å°ï¼Œä»–æ¯” du å¼ºçš„åœ°æ–¹å°±æ˜¯èƒ½å¤Ÿçœ‹åˆ°å·²ç»åˆ é™¤çš„æ–‡ä»¶ï¼Œè€Œä¸”è®¡ç®—å¤§å°çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸€éƒ¨åˆ†çš„ç©ºé—´ä¹ŸåŠ ä¸Šäº†ï¼Œæ›´ç²¾ç¡®äº†ã€‚

```sh
# æŸ¥çœ‹ç£ç›˜å‰©ä½™ç©ºé—´
$ df -ah

$ df --block-size=GB/-k/-m

# æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„ç›®å½•ç©ºé—´å ç”¨
$ du -h --max-depth=1 /var/ | sort

# æŸ¥çœ‹ tmp ç›®å½•çš„ç£ç›˜å ç”¨
$ du -sh /tmp

# æŸ¥çœ‹å½“å‰ç›®å½•åŒ…å«å­ç›®å½•çš„å¤§å°
$ du -sm .

# æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶å°ºå¯¸
$ ls -l --sort=size --block-size=M
```

ä½¿ç”¨ `fuser tmpFile.js` æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶è¢«è¿›ç¨‹å ç”¨æƒ…å†µï¼Œ

# æ–‡æœ¬å¤„ç†

## tail & head & cat & more

`tailf` å‘½ä»¤ç±»ä¼¼äº `tail -f`ï¼Œå…¶å¯ä»¥æ‰“å°å‡ºæ–‡ä»¶çš„æœ€ååè¡Œå†…å®¹ï¼Œå¹¶ä¸”ä¼šéšç€æ–‡ä»¶çš„å¢é•¿è€Œè‡ªåŠ¨æ»šåŠ¨ï¼›ä¸è¿‡å…¶ä¸ä¼šåœ¨æ–‡ä»¶æ²¡æœ‰å˜åŒ–çš„æ—¶å€™å»é¢‘ç¹è®¿é—®æ–‡ä»¶ã€‚

```sh
$ head -5 /etc/passwd

$ tail -10 /etc/passwd
$ tail -n 10 /etc/passwd
$ tail -f /var/log/messages

# æŸ¥çœ‹æ–‡ä»¶ä¸­é—´çš„ç¬¬ 5-10 è¡Œ
$ sed -n '5,10p' /etc/passwd
```

## grep & ack

grepï¼ˆglobal search regular expression(RE) and print out the lineï¼Œå…¨é¢æœç´¢æ­£åˆ™è¡¨è¾¾å¼å¹¶æŠŠè¡Œæ‰“å°å‡ºæ¥ï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œå®ƒèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼Œå¹¶æŠŠåŒ¹é…çš„è¡Œæ‰“å°å‡ºæ¥ã€‚

```sh
# åŸºæœ¬æ£€ç´¢
$ grep match_pattern file_name
$ grep "match_pattern" file_1 file_2 file_3 ...

# ä»…æ˜¾ç¤ºä¸åŒ¹é…çš„æ–‡æœ¬
$ grep -v "match_pattern" file_1 file_2 file_3 ...

# æœç´¢å¤šä¸ªæ–‡ä»¶å¹¶æŸ¥æ‰¾åŒ¹é…æ–‡æœ¬åœ¨å“ªäº›æ–‡ä»¶ä¸­
$ grep -l "text" file1 file2 file3...

# é€’å½’æ£€ç´¢
$ grep "text" . -r -n
#åªåœ¨ç›®å½•ä¸­æ‰€æœ‰çš„.phpå’Œ.htmlæ–‡ä»¶ä¸­é€’å½’æœç´¢å­—ç¬¦"main()"
$ grep "main()" . -r --include *.{php,html}
#åœ¨æœç´¢ç»“æœä¸­æ’é™¤æ‰€æœ‰READMEæ–‡ä»¶
$ grep "main()" . -r --exclude "README"
#åœ¨æœç´¢ç»“æœä¸­æ’é™¤filelistæ–‡ä»¶åˆ—è¡¨é‡Œçš„æ–‡ä»¶
$ grep "main()" . -r --exclude-from filelist

# æ­£åˆ™è¡¨è¾¾å¼æ£€ç´¢
$ grep -E "[1-9]+"
$ egrep "[1-9]+"

# æ£€ç´¢å½“å‰ç›®å½•ä¸‹
$ grep 'John Resig' *

# åªè¾“å‡ºæ–‡ä»¶ä¸­åŒ¹é…åˆ°çš„éƒ¨åˆ† -o é€‰é¡¹
$ echo this is a test line. | grep -o -E "[a-z]+\."
# è¾“å‡ºæ¨¡æ¿åœ¨æ–‡æœ¬ä¸­åŒ¹é…è¡Œæ•°
$ grep -c "text" file_name
# è¾“å‡ºå­—ç¬¦çš„æ€»åŒ¹é…è¡Œæ•°
$ grep "text" file_name | wc -l
# å¿½ç•¥å­—ç¬¦ä¸²å¤§å°å†™
$ echo "hello world" | grep -i "HELLO"

# æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æœä¹‹åçš„3è¡Œï¼Œä½¿ç”¨ -A é€‰é¡¹ï¼Œ-B æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æœä¹‹å‰çš„3è¡Œï¼Œ -C æ˜¾ç¤ºåŒ¹é…æŸä¸ªç»“æœçš„å‰ä¸‰è¡Œå’Œåä¸‰è¡Œ
$ seq 10 | grep "5" -A 3

# ä¸å…¶ä»–å‘½ä»¤ååŒä½¿ç”¨
$ grep foo $(find . -name '*.pm' | grep -v .svn)
$ ls -l | grep .py
```

```sh
# ack é»˜è®¤è¿›è¡Œé€’å½’æœç´¢
$ ack hello
$ ack -i hello
$ ack -v hello
$ ack -w hello
$ ack -Q 'hello*'

# è¾“å‡ºæ–‡ä»¶æŒ‡å®šå†…å®¹
# è¾“å‡ºæ‰€æœ‰æ–‡ä»¶ç¬¬äºŒè¡Œ
$ ack --line=1

# ä¹Ÿå¯ä»¥æŒ‡å®šç›®å½•/æ–‡ä»¶å/æ–‡ä»¶ç±»å‹æ£€ç´¢
# æŸ¥æ‰¾æ‰€æœ‰pythonæ–‡ä»¶
$ ack --python hello
# æŸ¥æ‰¾åŒ¹é…æ­£åˆ™çš„æ–‡ä»¶
$ ack -G hello.py$ hello

# ack èƒ½å¤Ÿå¯¹æœç´¢ç»“æœè¿›è¡Œæ–¹ä¾¿åœ°å®šåˆ¶
# ä»…æ˜¾ç¤ºåŒ…å«çš„æ–‡ä»¶å
$ ack -l 'hello'
# ä»…æ˜¾ç¤ºéåŒ…å«æ–‡ä»¶å
$ ack -L 'print'
# ä»¥lesså½¢å¼å±•ç¤º
$ ack hello --pager='less -R'
# ä¸åœ¨å¤´ä¸Šæ˜¾ç¤ºæ–‡ä»¶
$ ack hello --noheading
# ä¸å¯¹åŒ¹é…å­—ç¬¦ç€è‰²
$ ack hello --nocolor

# ack åŒæ ·èƒ½å¤Ÿç”¨äºæŸ¥æ‰¾æ–‡ä»¶
# æŸ¥æ‰¾å…¨åŒ¹é…æ–‡ä»¶
$ ack -f hello.py
# æŸ¥æ‰¾æ­£åˆ™åŒ¹é…æ–‡ä»¶
$ ack -g hello.pyf
#æŸ¥æ‰¾ç„¶åæ’åº
$ ack -g hello --sort-files
```

[ag](https://github.com/ggreer/the_silver_searcher) æ˜¯ç±»ä¼¼äº ack ä½†æ˜¯æ€§èƒ½æ›´ä¼˜åœ°å·¥å…·ã€‚

# ç”¨æˆ·æƒé™

## SSH

```sh
# ç”Ÿæˆåä¸º id_rsa çš„ç§é’¥æ–‡ä»¶å’Œåä¸º id_rsa.pub çš„å…¬é’¥æ–‡ä»¶
$ ssh-keygen -t rsa

# æŒ‡å®š 4096 ä½çš„é•¿åº¦
$ ssh-keygen -b 4096 -t rsa

# ä½¿ç”¨ ssh-copy-id æ·»åŠ å…¬é’¥
ssh-copy-id username@remote-server
```

ç”Ÿæˆçš„ id_rsa.pub å…¬é’¥æ–‡ä»¶ä¹Ÿå¯ä»¥ç”¨äºé…ç½® Git ä»“åº“çš„ SSH è®¿é—®ç­‰ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ssh ç™»å½•åˆ°æœ¬æœº(åˆ‡æ¢ç”¨æˆ·)æˆ–è€…è¿œç«¯ Linux è®¾å¤‡ä¸­ï¼Œé€šè¿‡å°†æœ¬æœºç”Ÿæˆçš„å…¬é’¥æ–‡ä»¶å†™å…¥ç›®æ ‡æœºå™¨çš„ authorized_keys å³å¯ä»¥å®ç°å…å¯†ç ç™»å½•ã€‚

## ç”¨æˆ·ç®¡ç†

å°† shell åˆ‡æ¢ä¸ºå…¶ä»–ç”¨æˆ·ï¼Œä½¿ç”¨ `su username` æˆ–è€… `sudo - username`ï¼ŒåŠ å…¥ `-` ä¼šä½¿å¾—åˆ‡æ¢åçš„ç¯å¢ƒä¸ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å½•åçš„ç¯å¢ƒç›¸åŒï¼Œçœç•¥ç”¨æˆ·ååˆ™é»˜è®¤ä¸º rootã€‚

## æƒé™è®¾ç½®

```sh
$ find /opt/lampp/htdocs -type f -exec chmod 644 {} \;
```

# ç³»ç»Ÿè¿›ç¨‹

## ç³»ç»ŸåŸºç¡€

- ä½¿ç”¨ `hostname` æŸ¥çœ‹å½“å‰ä¸»æœºåï¼Œä½¿ç”¨ `sudo hostname newName` ä¿®æ”¹å½“å‰ä¸»æœºå

```sh
# æ˜¾ç¤ºå½“å‰ä¸»æœºçš„ä¿¡æ¯
$ hostnamectl

# è®¾ç½®ä¸»æœºåã€‚
$ sudo hostnamectl set-hostname rhel7
```

- æŸ¥çœ‹ Linux ç³»ç»Ÿç‰ˆæœ¬

```bash
# æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬
$ cat /proc/version
Linux version 2.6.18-238.el5 (mockbuild@x86-012.build.bos.redhat.com) (gcc version 4.1.2 20080704 (Red Hat 4.1.2-50)) #1 SMP Sun Dec 19 14:22:44 EST 2010

$ uname -r
2.6.18-238.el5

$ uname -a
Linux SOR_SYS.99bill.com 2.6.18-238.el5 #1 SMP Sun Dec 19 14:22:44 EST 2010 x86_64 x86_64 x86_64 GNU/Linux

# æŸ¥çœ‹ Linux å‘è¡Œç‰ˆæœ¬
$ lsb_release -a

$ cat /etc/issue

Red Hat Enterprise Linux Server release 5.6 (Tikanga)
Kernel \r on an \m

$ file /bin/bash

/bin/bash: ELF 64-bit LSB executable, AMD x86-64, version 1 (SYSV), for GNU/Linux 2.6.9, dynamically linked (uses shared libs), for GNU/Linux 2.6.9, stripped
```

## è¿è¡ŒçŠ¶æ€

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `uptime` æˆ–è€… `w` æ¥æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æ¥å…¥æ—¶é—´ï¼š

```sh
$ w

# 15:33:49 up 58 days,  5:45,  1 user,  load average: 0.12, 0.15, 0.22
# USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT
# root     pts/1     15:15   49.00s  0.04s  0.00s w
```

æŸ¥çœ‹ç³»ç»Ÿå½“å‰çš„ CPU ä¸å†…å­˜æƒ…å†µï¼š

```sh
$ lscpu
```

## ç³»ç»ŸæœåŠ¡

systemctl status å‘½ä»¤ç”¨äºæŸ¥çœ‹ç³»ç»ŸçŠ¶æ€å’Œå•ä¸ª Unit çš„çŠ¶æ€ã€‚

```sh
# æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€
$ systemctl status

# æ˜¾ç¤ºå•ä¸ª Unit çš„çŠ¶æ€
$ sysystemctl status bluetooth.service

# æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„æŸä¸ª Unit çš„çŠ¶æ€
$ systemctl -H root@rhel7.example.com status httpd.service
```

æˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯ Unit ç®¡ç†å‘½ä»¤ï¼š

```sh
# ç«‹å³å¯åŠ¨ä¸€ä¸ªæœåŠ¡
$ sudo systemctl start apache.service

# ç«‹å³åœæ­¢ä¸€ä¸ªæœåŠ¡
$ sudo systemctl stop apache.service

# é‡å¯ä¸€ä¸ªæœåŠ¡
$ sudo systemctl restart apache.service

# æ€æ­»ä¸€ä¸ªæœåŠ¡çš„æ‰€æœ‰å­è¿›ç¨‹
$ sudo systemctl kill apache.service

# é‡æ–°åŠ è½½ä¸€ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶
$ sudo systemctl reload apache.service

# é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶
$ sudo systemctl daemon-reload

# æ˜¾ç¤ºæŸä¸ª Unit çš„æ‰€æœ‰åº•å±‚å‚æ•°
$ systemctl show httpd.service

# æ˜¾ç¤ºæŸä¸ª Unit çš„æŒ‡å®šå±æ€§çš„å€¼
$ systemctl show -p CPUShares httpd.service

# è®¾ç½®æŸä¸ª Unit çš„æŒ‡å®šå±æ€§
$ sudo systemctl set-property httpd.service CPUShares=500
```

## è¿›ç¨‹ç›‘æ§

- ä½¿ç”¨ `top` æŸ¥çœ‹è¿›ç¨‹èµ„æºå ç”¨æƒ…å†µï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±• htop æˆ–è€… gtopï¼›å¦‚æœé’ˆå¯¹å®¹å™¨ç›‘æ§ï¼Œå¯ä»¥ä½¿ç”¨ [ctop](https://github.com/bcicen/ctop)ã€‚

- ä½¿ç”¨ `pstree -p` æŸ¥çœ‹å½“å‰è¿›ç¨‹æ ‘ï¼Œä½¿ç”¨ `ps -A` æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œä½¿ç”¨ `ps -aux` æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨å†…å­˜ä¸­çš„ç¨‹åºï¼Œä½¿ç”¨ `ps -ef` æŸ¥çœ‹æ‰€æœ‰è¿åŒå‘½ä»¤è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼›ä½¿ç”¨ `ps -u root` æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·ä¿¡æ¯ï¼›ä½¿ç”¨ `ps -ef | grep ssh` æŸ¥çœ‹ç‰¹å®šè¿›ç¨‹ã€‚

## è¿›ç¨‹ç®¡ç†

```sh
$ pkill -f java
```

ulimit å‘½ä»¤ç”¨æ¥é™åˆ¶ç³»ç»Ÿç”¨æˆ·å¯¹ shell èµ„æºçš„è®¿é—®ã€‚ulimit ç”¨äºé™åˆ¶ shell å¯åŠ¨è¿›ç¨‹æ‰€å ç”¨çš„èµ„æºï¼Œæ”¯æŒä»¥ä¸‹å„ç§ç±»å‹çš„é™åˆ¶ï¼šæ‰€åˆ›å»ºçš„å†…æ ¸æ–‡ä»¶çš„å¤§å°ã€è¿›ç¨‹æ•°æ®å—çš„å¤§å°ã€Shell è¿›ç¨‹åˆ›å»ºæ–‡ä»¶çš„å¤§å°ã€å†…å­˜é”ä½çš„å¤§å°ã€å¸¸é©»å†…å­˜é›†çš„å¤§å°ã€æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ã€åˆ†é…å †æ ˆçš„æœ€å¤§å¤§å°ã€CPU æ—¶é—´ã€å•ä¸ªç”¨æˆ·çš„æœ€å¤§çº¿ç¨‹æ•°ã€Shell è¿›ç¨‹æ‰€èƒ½ä½¿ç”¨çš„æœ€å¤§è™šæ‹Ÿå†…å­˜ã€‚åŒæ—¶ï¼Œå®ƒæ”¯æŒç¡¬èµ„æºå’Œè½¯èµ„æºçš„é™åˆ¶ã€‚

æˆ‘ä»¬å¸¸ç”¨çš„å°±æ˜¯åœ¨ Web æœåŠ¡å™¨ä¸Šä¿®æ”¹æ¯ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ï¼š

```sh
$ ulimit -n 4096 # å°†æ¯ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶æ•°ç›®åŠ å¤§åˆ°4096ï¼Œç¼ºçœä¸º1024
```

å…¶ä»–å»ºè®®è®¾ç½®æˆæ— é™åˆ¶ï¼ˆunlimitedï¼‰çš„ä¸€äº›é‡è¦è®¾ç½®æ˜¯ï¼š

```sh
$ ulimit -d unlimited # æ•°æ®æ®µé•¿åº¦
$ ulimit -m unlimited # æœ€å¤§å†…å­˜å¤§å°
$ ulimit -s unlimited # å †æ ˆå¤§å°
$ ulimit -t unlimited # CPU æ—¶é—´
$ ulimit -v unlimited # è™šæ‹Ÿå†…å­˜
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼æ°¸ä¹…å†™å…¥ï¼š

```sh
vi /etc/security/limits.conf
# æ·»åŠ å¦‚ä¸‹çš„è¡Œ
* soft noproc 11000
* hard noproc 11000
* soft nofile 4100
* hard nofile 4100
# è¯´æ˜ï¼š* ä»£è¡¨é’ˆå¯¹æ‰€æœ‰ç”¨æˆ·ï¼Œnoproc æ˜¯ä»£è¡¨æœ€å¤§è¿›ç¨‹æ•°ï¼Œnofile æ˜¯ä»£è¡¨æœ€å¤§æ–‡ä»¶æ‰“å¼€æ•°
```

## Cron

![](http://fs.gimoo.net/img/2014/10/12/011835_5439666b84167.jpg)

```sh
\*ã€€ã€€ \*ã€€ã€€ \*ã€€ã€€ \*ã€€ã€€ \*ã€€ã€€ command
åˆ†ã€€   æ—¶ã€€   æ—¥ã€€   æœˆã€€   å‘¨ã€€   å‘½ä»¤
```

ç¬¬ 1 åˆ—è¡¨ç¤ºåˆ†é’Ÿ 1 ï½ 59 æ¯åˆ†é’Ÿç”¨*æˆ–è€… */1 è¡¨ç¤ºç¬¬ 2 åˆ—è¡¨ç¤ºå°æ—¶ 1 ï½ 23 ( 0 è¡¨ç¤º 0 ç‚¹)ç¬¬ 3 åˆ—è¡¨ç¤ºæ—¥æœŸ 1 ï½ 31 ç¬¬ 4 åˆ—è¡¨ç¤ºæœˆä»½ 1 ï½ 12 ç¬¬ 5 åˆ—æ ‡è¯†å·æ˜ŸæœŸ 0 ï½ 6 ( 0 è¡¨ç¤ºæ˜ŸæœŸå¤©)ç¬¬ 6 åˆ—è¦è¿è¡Œçš„å‘½ä»¤

åœ¨ä»¥ä¸Šå„ä¸ªå­—æ®µä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç‰¹æ®Šå­—ç¬¦ï¼š

æ˜Ÿå·(\* )ï¼šä»£è¡¨æ‰€æœ‰å¯èƒ½çš„å€¼ï¼Œä¾‹å¦‚ month å­—æ®µå¦‚æœæ˜¯æ˜Ÿå·ï¼Œåˆ™è¡¨ç¤ºåœ¨æ»¡è¶³å…¶å®ƒå­—æ®µçš„åˆ¶çº¦æ¡ä»¶åæ¯æœˆéƒ½æ‰§è¡Œè¯¥å‘½ä»¤æ“ä½œã€‚

é€—å·(, )ï¼šå¯ä»¥ç”¨é€—å·éš”å¼€çš„å€¼æŒ‡å®šä¸€ä¸ªåˆ—è¡¨èŒƒå›´ï¼Œä¾‹å¦‚ï¼Œâ€œ1,2,5,7,8,9â€

ä¸­æ (- )ï¼šå¯ä»¥ç”¨æ•´æ•°ä¹‹é—´çš„ä¸­æ è¡¨ç¤ºä¸€ä¸ªæ•´æ•°èŒƒå›´ï¼Œä¾‹å¦‚ â€œ2-6â€ è¡¨ç¤º â€œ2,3,4,5,6â€

æ­£æ–œçº¿(/ )ï¼šå¯ä»¥ç”¨æ­£æ–œçº¿æŒ‡å®šæ—¶é—´çš„é—´éš”é¢‘ç‡ï¼Œä¾‹å¦‚ â€œ0-23/2â€ è¡¨ç¤ºæ¯ä¸¤å°æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚åŒæ—¶æ­£æ–œçº¿å¯ä»¥å’Œæ˜Ÿå·ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ \*/10ï¼Œå¦‚æœç”¨åœ¨ minute å­—æ®µï¼Œè¡¨ç¤ºæ¯ååˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚

cron æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥æ ¹æ®æ—¶é—´ã€æ—¥æœŸã€æœˆä»½ã€æ˜ŸæœŸçš„ç»„åˆæ¥è°ƒåº¦å¯¹é‡å¤ä»»åŠ¡çš„æ‰§è¡Œçš„å®ˆæŠ¤è¿›ç¨‹ã€‚

cron å‡å®šç³»ç»ŸæŒç»­è¿è¡Œã€‚å¦‚æœå½“æŸä»»åŠ¡è¢«è°ƒåº¦æ—¶ç³»ç»Ÿä¸åœ¨è¿è¡Œï¼Œè¯¥ä»»åŠ¡å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚âˆšâˆš

# ç½‘ç»œ

## ç½‘ç»œçŠ¶æ€

```sh
# æŸ¥çœ‹æŒ‡å®šç«¯å£çš„å ç”¨æƒ…å†µ
$ lsof -i:80
$ kill -9 $(lsof -t -i:8080)
# æŸ¥çœ‹æŸä¸ªè¿›ç¨‹çš„ TCP è¿æ¥
$ lsof -p <pid> | grep TCP

# æŸ¥çœ‹ TCP è¿æ¥æ•°
$ netstat -an
# ç»Ÿè®¡80ç«¯å£è¿æ¥æ•°
$ netstat -nat|grep -i "80"|wc -l
# ç»Ÿè®¡ IP åœ°å€è¿æ¥æ•°
netstat -na|grep ESTABLISHED|awk {print $5}|awk -F: {print $1}| sort |uniq -c|sort -r +0n

netstat -na|grep SYN|awk {print $5}|awk -F: {print $1}|sort|uniq -c|sort -r +0n
```

## ç½‘ç»œé…ç½®

## ç½‘ç»œè¯·æ±‚

```sh
# å±•ç¤º curl çš„è¿›åº¦
$ curl --progress-bar -T "${SOME_LARGE_FILE}" "${UPLOAD_URL}" | tee /dev/null
```

# Todos

- [ ] [the-art-of-command-line](https://parg.co/bXZ)
- [ ] [Linux Commands Cheat Sheet](https://parg.co/Uqu)
